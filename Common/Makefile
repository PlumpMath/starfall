## Copyright (c) 2013 Mark Farrell

CC=clang

STARFALL_DEPENDENCIES = $(HOME)/Development

POCO_DIR=poco-1.4.6p1-all

STARFALL_INCLUDES := -I $(STARFALL_DEPENDENCIES)/$(POCO_DIR)/Foundation/include
STARFALL_INCLUDES := $(STARFALL_INCLUDES) -I  $(STARFALL_DEPENDENCIES)/$(POCO_DIR)/Net/include
STARFALL_INCLUDES := $(STARFALL_INCLUDES) -I  $(STARFALL_DEPENDENCIES)/$(POCO_DIR)/Util/include 
STARFALL_INCLUDES := $(STARFALL_INCLUDES) -I  $(STARFALL_DEPENDENCIES)/$(POCO_DIR)/JSON/include
STARFALL_INCLUDES := $(STARFALL_INCLUDES) -I  $(STARFALL_DEPENDENCIES)/$(POCO_DIR)/XML/include
STARFALL_INCLUDES := $(STARFALL_INCLUDES) -I  $(STARFALL_DEPENDENCIES)/$(POCO_DIR)/Data/include
STARFALL_INCLUDES := $(STARFALL_INCLUDES) -I  $(STARFALL_DEPENDENCIES)/$(POCO_DIR)/Data/SQLite/include
STARFALL_INCLUDES := $(STARFALL_INCLUDES) -I  $(STARFALL_DEPENDENCIES)/v8/include
STARFALL_INCLUDES := $(STARFALL_INCLUDES) -I  $(STARFALL_DEPENDENCIES)/glm

STARFALL_INCLUDES := $(STARFALL_INCLUDES)  -I Include

STARFALL_COMMON_SRC = Source/Starfall
STARFALL_COMMON_SRCS := $(wildcard $(STARFALL_COMMON_SRC)/*.cpp)

STARFALL_COMMON_OBJ := obj
STARFALL_COMMON_OBJS := $(patsubst $(STARFALL_COMMON_SRC)/%.cpp, $(STARFALL_COMMON_OBJ)/%.o, $(STARFALL_COMMON_SRCS))

STARFALL_COMMON_LIB := lib
STARFALL_COMMON_RELEASE := libcommon.a

.DEFAULT_GOAL := release

$(STARFALL_COMMON_LIB):
	mkdir -p $(STARFALL_COMMON_LIB)

$(STARFALL_COMMON_OBJ):
	mkdir -p $(STARFALL_COMMON_OBJ)

$(STARFALL_COMMON_OBJ)/%.o: $(STARFALL_COMMON_SRC)/%.cpp $(STARFALL_COMMON_OBJ)
	$(CC) -c -o $@ $< $(STARFALL_INCLUDES)

release: $(STARFALL_COMMON_OBJS) $(STARFALL_COMMON_LIB)
	ar rcs $(STARFALL_COMMON_LIB)/$(STARFALL_COMMON_RELEASE) $(STARFALL_COMMON_OBJ)/*.o

.PHONY: clean

clean:
	rm -f $(STARFALL_COMMON_OBJ)/*.o
	rm -d $(STARFALL_COMMON_OBJ)
	rm -f $(STARFALL_COMMON_LIB)/*.a
	rm -d $(STARFALL_COMMON_LIB)
